<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    
    <h:head>
        <title>Listagem de Pessoas</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; padding: 20px; }
            .container { max-width: 1300px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); overflow: hidden; }
            .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; }
            .header h1 { font-size: 2.5rem; margin-bottom: 10px; font-weight: 700; }
            .content { padding: 40px; }
            .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px; }
            .btn { display: inline-flex; align-items: center; gap: 10px; padding: 12px 25px; text-decoration: none; border-radius: 10px; font-weight: 600; transition: all 0.3s ease; border: none; cursor: pointer; font-family: inherit; }
            .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); }
            .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
            .btn-secondary { background: #6c757d; color: white; }
            .btn-info { background: #17a2b8; color: white; }
            .btn-warning { background: #ffc107; color: #212529; }
            .btn-danger { background: #dc3545; color: white; }
            .btn-small { padding: 8px 15px; font-size: 0.85rem; }
            .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); border-radius: 10px; overflow: hidden; }
            .data-table th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 18px 15px; text-align: left; font-weight: 600; }
            .data-table td { padding: 16px 15px; border-bottom: 1px solid #f1f3f4; }
            .data-table tr:last-child td { border-bottom: none; }
            .data-table tr:hover { background-color: #f8f9fa; transform: translateY(-1px); transition: all 0.2s ease; }
            .badge { display: inline-block; padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin: 2px; }
            .badge-primary { background: #e3f2fd; color: #1976d2; }
            .badge-success { background: #e8f5e8; color: #2e7d32; }
            .badge-info { background: #e3f2fd; color: #1565c0; }
            .empty-state { text-align: center; padding: 60px 20px; color: #6c757d; }
            .action-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
            .status-indicator { display: inline-flex; align-items: center; gap: 5px; }
            .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #28a745; }
        </style>
    </h:head>
    
    <h:body>
        <div class="container">
            <div class="header">
                <h1>Listagem de Pessoas</h1>
                <p>Gerencie e visualize todos os cadastros do sistema</p>
            </div>
            
            <div class="content">
                <!-- Estat√≠sticas SIMPLES -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); text-align: center;">
                        <div style="font-size: 2rem; font-weight: 700; color: #667eea;">#{pessoaController.pessoas.size()}</div>
                        <div style="color: #6c757d; font-size: 0.9rem;">Total de Pessoas</div>
                    </div>
                </div>

                <div class="toolbar">
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <h:button value="‚ûï Nova Pessoa" outcome="cadastro" styleClass="btn btn-primary"/>
                        <h:button value="‚Ü∂ Voltar" outcome="index" styleClass="btn btn-secondary"/>
                    </div>
                </div>
                
                <h:form id="formLista" prependId="false">
                    <h:dataTable value="#{pessoaController.pessoas}" var="pessoa" 
                               styleClass="data-table"
                               rendered="#{not empty pessoaController.pessoas}">
                               
                        <h:column>
                            <f:facet name="header">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span>üë§ Nome Completo</span>
                                </div>
                            </f:facet>
                            <div>
                                <strong style="color: #2c3e50; font-size: 1.1em;">#{pessoa.nome}</strong>
                                <div style="margin-top: 5px;">
                                    <small style="color: #6c757d;">üìß #{pessoa.email}</small>
                                </div>
                            </div>
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">üìÖ Data Nascimento</f:facet>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <h:outputText value="#{pessoa.dataNascimento}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                                <div class="status-indicator">
                                    <span class="status-dot"></span>
                                    <small>Ativo</small>
                                </div>
                            </div>
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">üìä Contatos</f:facet>
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <span class="badge badge-primary">üè† #{pessoa.enderecos != null ? pessoa.enderecos.size() : 0} endere√ßo(s)</span>
                                <span class="badge badge-success">üìû #{pessoa.telefones != null ? pessoa.telefones.size() : 0} telefone(s)</span>
                                <span class="badge badge-info">üìÑ #{pessoa.documentos != null ? pessoa.documentos.size() : 0} documento(s)</span>
                            </div>
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">‚öôÔ∏è A√ß√µes</f:facet>
                            <div class="action-buttons">
                                <!-- SOLU√á√ÉO: Usar h:button com par√¢metros para passar o ID -->
                                <h:button value="‚úèÔ∏è Editar" outcome="cadastro" styleClass="btn btn-warning btn-small">
                                    <f:param name="id" value="#{pessoa.id}"/>
                                </h:button>
                                
                                <h:commandButton value="üóëÔ∏è Excluir" styleClass="btn btn-danger btn-small"
                                               action="#{pessoaController.excluir(pessoa)}"
                                               onclick="return confirm('Tem certeza que deseja excluir #{pessoa.nome}?')"/>
                            </div>
                        </h:column>
                    </h:dataTable>
                </h:form>

                <!-- Estado vazio -->
                <ui:fragment rendered="#{empty pessoaController.pessoas}">
                    <div class="empty-state">
                        <h3 style="color: #6c757d; margin-bottom: 15px;">Nenhuma pessoa cadastrada</h3>
                        <p style="margin-bottom: 25px; color: #8a8a8a;">Comece cadastrando a primeira pessoa no sistema</p>
                        <h:button value="‚ûï Cadastrar Primeira Pessoa" outcome="cadastro" styleClass="btn btn-primary"/>
                    </div>
                </ui:fragment>
            </div>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Efeitos de hover nas linhas da tabela
                const tableRows = document.querySelectorAll('.data-table tr');
                tableRows.forEach(row => {
                    row.addEventListener('mouseenter', function() {
                        this.style.backgroundColor = '#f8f9fa';
                        this.style.transform = 'translateY(-1px)';
                        this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                    });
                    
                    row.addEventListener('mouseleave', function() {
                        this.style.backgroundColor = '';
                        this.style.transform = 'translateY(0)';
                        this.style.boxShadow = 'none';
                    });
                });

                // Efeitos nos bot√µes
                const buttons = document.querySelectorAll('.btn');
                buttons.forEach(button => {
                    button.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-2px)';
                    });
                    
                    button.addEventListener('mouseleave', function() {
                        this.style.transform = 'translateY(0)';
                    });
                });

                // Confirma√ß√£o para exclus√£o
                const deleteButtons = document.querySelectorAll('.btn-danger');
                deleteButtons.forEach(button => {
                    button.addEventListener('click', function(e) {
                        if (!confirm('Tem certeza que deseja excluir este registro?')) {
                            e.preventDefault();
                        }
                    });
                });
            });
        </script>
    </h:body>
</html>